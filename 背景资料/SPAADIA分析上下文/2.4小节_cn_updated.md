### 2.4 统计建模方法

服务对话数据呈现典型的多层嵌套结构：话轮嵌套于说话人内，说话人又嵌套于对话内。这种层级结构违反了独立性假设（Gelman & Hill, 2007），导致标准误低估和错误的统计推断。当同一说话人的多个话轮共享未观测特征时，残差将呈现聚类相关性，违反了普通最小二乘法的独立同分布假设。本研究通过零模型分析评估组间变异的程度，计算说话人层面和对话层面的组内相关系数（ICC），以确定多层建模的必要性。如果ICC值表明存在实质性的组内相关（Snijders & Bosker, 1999），将采用多层建模方法。

#### 2.4.1 数据处理与建模策略

本研究采用Python 3.9及以上版本进行数据预处理、变量构建和初步分析，特别是利用其在自然语言处理方面的优势计算语义指标。统计建模主要在Python中使用statsmodels（版本0.13+）和scikit-learn（版本1.0+）实现，包括混合效应模型、多项逻辑回归、马尔可夫链分析和变化点检测。对于需要特殊验证的分析，使用R 4.2及以上版本，特别是lme4包（版本1.1-31+）进行Kenward-Roger自由度近似，markovchain包（版本0.9.0+）进行马尔可夫链验证。这种分工充分利用了两种语言的优势，确保了分析的效率和准确性。

缺失数据采用多重插补法处理，在Python中使用advanced_statistics.py模块中的MultipleImputation类实现，插补次数设定为*m* = 5，采用迭代插补策略处理不同类型的变量。对于系统性缺失，在主要分析中使用完整案例，并通过敏感性分析评估对结果的影响。

考虑到多个假设的同时检验，对关键的理论检验采用Benjamini-Hochberg程序控制错误发现率（FDR）在0.05水平（见fdr_correction.py实现）。对于探索性分析，报告未校正的*p*值但在解释时明确说明。这种分层策略在保持统计功效的同时控制了整体的第一类错误率。

#### 2.4.2 假设特定模型设定

本研究采用一系列多层模型检验四个核心假设，每个模型都经过精心设计以捕捉数据的特定特征。表2.1总结了各假设的建模方法。

**表2.1 假设检验的统计建模方法汇总**

| 假设 | 分析方法 | 软件实现 | 关键参数 | 预期输出 |
|------|---------|----------|----------|----------|
| H1：框架激活双重机制 | 三层线性混合模型 | Python statsmodels + R lme4验证 | 随机截距与斜率 | 固定效应β、SE、95% CI |
| H2：框架驱动策略选择 | 多项逻辑回归（带聚类标准误） | Python statsmodels MNLogit | 效应编码 | OR、95% CI |
| H3：策略演化路径依赖 | 马尔可夫链+面板模型 | Python自定义实现 | 转换概率矩阵 | 转换概率、稳态分布 |
| H4：意义协商语义收敛 | 分段增长曲线模型 | Python scipy + numpy | 协商点检测 | 斜率变化、断点位置 |

由于技术实现的限制，某些分析方法与理想的多层模型存在差异。特别是假设2的多层多项逻辑回归，由于Python的statsmodels包尚未提供多层多项逻辑回归的直接实现，本研究采用了聚类稳健标准误的替代方案。这种方法通过按对话层面聚类计算稳健标准误来部分纠正数据依赖性带来的偏差，虽然不如真正的多层模型精确，但在计量经济学和应用统计中是公认的有效方法（Cameron & Miller, 2015）。未来研究可考虑使用专门的贝叶斯软件（如Stan或PyMC3）实现完整的多层多项逻辑回归。

**假设1：框架激活的双重机制**

假设1采用三层线性混合模型检验语境依赖性和机构预设性对框架激活的影响。基于数据特征和模型收敛考虑，采用渐进式模型构建策略（见hypothesis_h1_advanced.py）：

第1层（话轮层面）：
$$Y_{ijk} = \beta_{0jk} + \beta_{1jk} \times \text{CD}_{c,ijk} + \beta_{2jk} \times \text{IP}_{c,ijk} + \beta_3 \times (\text{CD}_{c} \times \text{IP}_{c})_{ijk} + \beta_4 \times \text{TaskComplexity}_{k} + \epsilon_{ijk}$$

第2层（说话人层面）：
$$\beta_{0jk} = \gamma_{00k} + u_{0jk}$$
$$\beta_{1jk} = \gamma_{10k} + u_{1jk}$$
$$\beta_{2jk} = \gamma_{20k} + u_{2jk}$$

第3层（对话层面）：
$$\gamma_{00k} = \delta_{000} + v_{00k}$$
$$\gamma_{10k} = \delta_{100} + v_{10k}$$
$$\gamma_{20k} = \delta_{200} + v_{20k}$$

其中：
- $Y_{ijk}$：框架激活强度（1-7连续量表）
- $\text{CD}_{c,ijk}$：中心化的语境依赖度（组均值中心化后的0-1连续值）
- $\text{IP}_{c,ijk}$：中心化的机构预设度（组均值中心化后的0-1连续值）
- $\text{TaskComplexity}_{k}$：任务复杂度（对话层面标准化指数）

随机效应假设：
$$\begin{pmatrix} u_{0jk} \\ u_{1jk} \\ u_{2jk} \end{pmatrix} \sim N\left(\begin{pmatrix} 0 \\ 0 \\ 0 \end{pmatrix}, \begin{pmatrix} \tau_{00} & \tau_{01} & \tau_{02} \\ \tau_{01} & \tau_{11} & \tau_{12} \\ \tau_{02} & \tau_{12} & \tau_{22} \end{pmatrix}\right)$$

模型估计在基础分析中使用最大似然法（ML）进行模型比较，在高级分析和最终模型中采用限制性最大似然法（REML）获得无偏参数估计。使用渐进式策略处理收敛问题：首先尝试完整模型（M2a：完整随机斜率），如不收敛则简化为M2b（仅CD随机斜率），最后退回到M2c（仅随机截距）。模型结果将报告固定效应的系数估计（β）、标准误（SE）、95%置信区间和效应量。

**假设2：框架驱动的策略选择**

假设2采用多项逻辑回归模型预测策略选择，以框架强化策略为参考类别。由于Python中缺乏真正的多层多项逻辑回归实现，使用单层模型配合聚类稳健标准误来近似考虑数据的层次结构：

$$\log\left(\frac{P(Y_{ijk} = s)}{P(Y_{ijk} = 1)}\right) = \beta_{0}^{(s)} + \beta_1^{(s)} \times \text{Frame}_{ijk} + \beta_2^{(s)} \times \text{Stage}_{ijk} + \beta_3^{(s)} \times \text{Position}_{ijk} + \beta_4^{(s)} \times \text{CogLoad}_{ijk} + \beta_5^{(s)} \times (\text{Frame} \times \text{Stage})_{ijk}$$

其中*s* ∈ {2, 3}分别代表框架转换和框架融合策略。控制变量包括相对话轮位置（0-1连续值）和认知负荷指数（1-10连续量表）。多项逻辑回归通过Python的statsmodels.discrete.discrete_model.MNLogit实现，采用效应编码（-1, 0, 1）确保参数解释的合理性。框架类型以交易框架为参考，使参数估计反映总体均值。模型将报告比值比（OR）及其95%置信区间。

**假设3：策略演化的路径依赖**

假设3结合三种互补的分析方法：

（1）马尔可夫链分析：构建策略转换概率矩阵*P* = [*p*ᵢⱼ]，其中*p*ᵢⱼ = P(*S*ₜ₊₁ = *j* | *S*ₜ = *i*)。分别计算服务提供者和客户的转换矩阵，使用1000次置换检验评估对角线优势的显著性。分析通过Python自定义实现，包括稳态分布计算和遍历性检验。

（2）生存分析：将策略持续时间作为生存时间，策略转换作为事件，使用Python的lifelines包进行Kaplan-Meier估计和Cox比例风险回归。

（3）固定效应面板模型：
$$\text{Efficacy}_{it} = \alpha_i + \beta_1 \times \text{Repetition}_{it} + \beta_2 \times \text{Repetition}_{it}^2 + \beta_3 \times (\text{Repetition} \times \text{Role})_{it} + \text{Controls} + \epsilon_{it}$$

其中*α*ᵢ为说话人固定效应，控制变量包括认知负荷、框架类型和相对位置。

**假设4：意义协商的语义收敛**

假设4采用分段增长曲线模型：

$$SD_{tk} = \beta_{0k} + \sum_{p=1}^{P_k} \beta_{pk} \times I(t > \tau_{pk}) \times (t - \tau_{pk}) + \epsilon_{tk}$$

其中*SD*ₜₖ为语义距离（0-1连续值），可使用TF-IDF余弦相似度或Word2Vec模型计算。协商点通过CUSUM算法自动识别，检测阈值设置为标准差的1.5倍。识别标准包括框架转换伴随语义距离突变（Δ > 0.15）、策略类型改变、特定话语标记出现以及贡献率的显著变化（Δ > 0.20）。

#### 2.4.3 模型估计与诊断

在Python分析中，基础分析使用最大似然估计（ML）进行嵌套模型比较，高级分析和最终模型使用REML获得无偏方差估计。在R验证分析中，通过pbkrtest包（版本0.5.2）使用Kenward-Roger自由度近似（Kenward & Roger, 1997）改进小样本推断。方差成分的置信区间通过轮廓似然法计算，避免基于正态性假设的偏差。收敛诊断标准包括梯度范数小于1e-5和Hessian矩阵正定性检验。对于边界估计（方差接近零），采用简化模型策略。

模型构建遵循理论驱动的递进策略。首先拟合零模型（M0）计算组内相关系数，随后依次添加主效应（M1）、二阶交互项（M2）和高阶交互项（M3）。模型比较使用似然比检验，当*p* < .05且Δ*AIC* > 2时保留更复杂的模型。

模型诊断包括：多重共线性通过方差膨胀因子（VIF）评估，采用临界值10作为判断标准；残差诊断检查分位数残差的均匀性和离散度；影响诊断通过Cook距离识别异常观察值，阈值设定为4/*n*。

敏感性分析包括三个方面（见sensitivity_analysis.py实现）：（1）使用不同的语义距离计算方法（TF-IDF余弦相似度 vs Word2Vec）验证结果稳健性；（2）改变协商点识别的阈值参数（1.0-2.0标准差）检查结果稳定性；（3）比较不同的随机效应结构对主要结论的影响。

统计功效分析（见power_analysis.py实现）使用蒙特卡洛模拟方法。基于观察到的效应量和方差成分，通过1000次模拟评估检测中等效应（Cohen's *d* = 0.5）的能力。结果显示，对于固定效应和解释5%以上方差的随机效应，当前样本量下统计功效达到80%，支持主要假设检验的可靠性。


#### 2.4.4 分析质量保证

为确保统计推断的有效性和研究结论的可靠性，本研究实施了三项质量保证程序。

**多重比较校正**作为统计推断的质量控制措施，处理了同时检验四个假设带来的第一类错误膨胀问题。研究采用Benjamini-Hochberg程序控制错误发现率在0.05水平，对关键理论检验和探索性分析实施分层处理。这种策略在维持适当统计功效的同时，确保了整体推断的有效性。校正后的显著性水平为后续的理论解释提供了可靠基础。

**统计功效评估**通过蒙特卡洛模拟（1000次迭代）检验了研究设计的充分性。基于观察到的效应量和方差成分，分析显示当前样本量能够以80%以上的概率检测主要固定效应的中等效应量（Cohen's *d* = 0.5）。然而，三阶交互效应的检测功效降至60-70%，这一限制将在结果解释时予以考虑。功效分析明确了研究的检测能力边界，为理解哪些效应可能因样本量限制而未被发现提供了重要信息。

**敏感性分析**系统评估了主要发现对分析决策的稳健性。语义距离计算采用TF-IDF余弦相似度和Word2Vec词嵌入两种方法交叉验证，两者高度相关（*r* = 0.78, *p* < .001）且产生一致的理论结论。协商点识别阈值在1.0-2.0个标准差范围内变化时，85%的协商点分类保持稳定。随机效应结构的不同设定对固定效应估计影响甚微（变化幅度< 10%），关键效应的显著性维持不变。这些检验证实了研究发现不依赖于特定的方法论选择。

这三项质量保证程序从不同角度增强了研究的方法论严谨性，为理论贡献的可信度提供了多重保障。


